============================================================
1. ЗАГРУЗКА И ПОДГОТОВКА ДАННЫХ
============================================================
Размер датасета: (50000, 7)
Столбцы: ['Manufacturer', 'Model', 'Engine size', 'Fuel type', 'Year of manufacture', 'Mileage', 'Price']

Первые 5 строк:
  Manufacturer       Model  Engine size Fuel type  Year of manufacture  Mileage  Price
0         Ford      Fiesta          1.0    Petrol                 2002   127300   3074
1      Porsche  718 Cayman          4.0    Petrol                 2016    57850  49704
2         Ford      Mondeo          1.6    Diesel                 2014    39190  24072
3       Toyota        RAV4          1.8    Hybrid                 1988   210814   1705
4           VW        Polo          1.0    Petrol                 2006   127869   4101

Проверка пропущенных значений:
Fuel type              0
Manufacturer           0
Engine size            0
Year of manufacture    0
Mileage                0
dtype: int64

Размеры выборок:
X_train: (32000, 11)
X_val: (8000, 11)
X_test: (10000, 11)

============================================================
2. ОПИСАНИЕ 5 МОДЕЛЕЙ НЕЙРОННЫХ СЕТЕЙ
============================================================
Размер входного вектора: 11
2025-12-14 19:56:39.734707: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.

Создано 5 моделей нейронных сетей:

Модель 1: Простая сеть (2 слоя):
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense (Dense)                        │ (None, 64)                  │             768 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_1 (Dense)                      │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_2 (Dense)                      │ (None, 1)                   │              33 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 2,881 (11.25 KB)
 Trainable params: 2,881 (11.25 KB)
 Non-trainable params: 0 (0.00 B)

Модель 2: Глубокая сеть (4 слоя):
Model: "sequential_1"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense_3 (Dense)                      │ (None, 128)                 │           1,536 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_4 (Dense)                      │ (None, 64)                  │           8,256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_5 (Dense)                      │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_6 (Dense)                      │ (None, 16)                  │             528 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_7 (Dense)                      │ (None, 1)                   │              17 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 12,417 (48.50 KB)
 Trainable params: 12,417 (48.50 KB)
 Non-trainable params: 0 (0.00 B)

Модель 3: Широкая сеть:
Model: "sequential_2"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense_8 (Dense)                      │ (None, 256)                 │           3,072 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_9 (Dense)                      │ (None, 128)                 │          32,896 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_10 (Dense)                     │ (None, 1)                   │             129 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 36,097 (141.00 KB)
 Trainable params: 36,097 (141.00 KB)
 Non-trainable params: 0 (0.00 B)

Модель 4: Сеть с Dropout:
Model: "sequential_3"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense_11 (Dense)                     │ (None, 128)                 │           1,536 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 128)                 │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_12 (Dense)                     │ (None, 64)                  │           8,256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_13 (Dense)                     │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_14 (Dense)                     │ (None, 1)                   │              33 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 11,905 (46.50 KB)
 Trainable params: 11,905 (46.50 KB)
 Non-trainable params: 0 (0.00 B)

Модель 5: Сеть с BatchNorm:
Model: "sequential_4"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense_15 (Dense)                     │ (None, 128)                 │           1,536 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization                  │ (None, 128)                 │             512 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_16 (Dense)                     │ (None, 64)                  │           8,256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_1                │ (None, 64)                  │             256 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_17 (Dense)                     │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_2                │ (None, 32)                  │             128 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_18 (Dense)                     │ (None, 1)                   │              33 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 12,801 (50.00 KB)
 Trainable params: 12,353 (48.25 KB)
 Non-trainable params: 448 (1.75 KB)

============================================================
3. ОБУЧЕНИЕ МОДЕЛЕЙ И АНАЛИЗ РЕЗУЛЬТАТОВ
============================================================

Обучение Модель 1: Простая сеть (2 слоя)...
Restoring model weights from the end of the best epoch: 148.
  Обучено эпох: 150
  Final Train Loss: 8389527.00
  Final Val Loss: 8871456.00

Обучение Модель 2: Глубокая сеть (4 слоя)...
Epoch 139: early stopping
Restoring model weights from the end of the best epoch: 119.
  Обучено эпох: 139
  Final Train Loss: 4958072.50
  Final Val Loss: 5154256.00

Обучение Модель 3: Широкая сеть...
Epoch 20: early stopping
Restoring model weights from the end of the best epoch: 1.
  Обучено эпох: 20
  Final Train Loss: 13304975.00
  Final Val Loss: 12175169.00

Обучение Модель 4: Сеть с Dropout...
Epoch 20: early stopping
Restoring model weights from the end of the best epoch: 1.
  Обучено эпох: 20
  Final Train Loss: 14930878.00
  Final Val Loss: 10587376.00

Обучение Модель 5: Сеть с BatchNorm...
Epoch 20: early stopping
Restoring model weights from the end of the best epoch: 1.
  Обучено эпох: 20
  Final Train Loss: 51323368.00
  Final Val Loss: 14447439.00

============================================================
4. ГРАФИКИ ПОТЕРЬ ДЛЯ КАЖДОЙ МОДЕЛИ
============================================================

============================================================
5. АНАЛИЗ ЭФФЕКТИВНОСТИ МОДЕЛЕЙ
============================================================

Сравнение моделей (от лучшей к худшей):
                          Модель  Лучшая Val Loss  Лучшая Train Loss  Эпоха с лучшим val_loss  Переобучение (train/val)
Модель 2: Глубокая сеть (4 слоя)        4886346.0          4911707.5                      119                  0.961938
 Модель 1: Простая сеть (2 слоя)        8859281.0          8389527.0                      148                  0.945676
        Модель 4: Сеть с Dropout       10587376.0         14930878.0                       20                  1.410253
          Модель 3: Широкая сеть       12175169.0         13304975.0                       20                  1.092796
      Модель 5: Сеть с BatchNorm       14447439.0         51323368.0                       20                  3.552420

============================================================
ВЫВОДЫ:
============================================================
1. Лучшая модель: Модель 2: Глубокая сеть (4 слоя)
   с Validation Loss: 4886346.0000

2. Анализ переобучения:
   Модель 2: Глубокая с 0.96 - ✓ БАЛАНС (хорошая обобщающая способность)
   Модель 1: Простая се 0.95 - ✓ БАЛАНС (хорошая обобщающая способность)
   Модель 4: Сеть с Dro 1.41 - ✗ ПЕРЕОБУЧЕНИЕ (train loss < val loss)
   Модель 3: Широкая се 1.09 - ✓ БАЛАНС (хорошая обобщающая способность)
   Модель 5: Сеть с Bat 3.55 - ✗ ПЕРЕОБУЧЕНИЕ (train loss < val loss)

3. Рекомендации:
   - Модели с регуляризацией (Dropout) обычно лучше обобщают
   - Слишком глубокие сети могут переобучаться на небольших данных
   - BatchNormalization ускоряет обучение и улучшает стабильность

============================================================
6. ТЕСТИРОВАНИЕ ЛУЧШЕЙ МОДЕЛИ НА ТЕСТОВОЙ ВЫБОРКЕ
============================================================
313/313 ━━━━━━━━━━━━━━━━━━━━ 0s 628us/step

Модель: Модель 2: Глубокая сеть (4 слоя)
Test MSE: 5688035.00
Test MAE: 1037.91
R² Score: 0.9790

============================================================
ЛАБОРАТОРНАЯ РАБОТА ВЫПОЛНЕНА!
============================================================